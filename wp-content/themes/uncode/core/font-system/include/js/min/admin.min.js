$=jQuery.noConflict(),jQuery(document).ready(function($){$(".if-js-closed").removeClass("if-js-closed").addClass("closed"),postboxes.add_postbox_toggles("uncodefont");var t=UncodeFontJS.font_stack;t=$.parseJSON(t);var e={n1:"Thin",n2:"Extra Light",n3:"Light",n4:"Regular",n5:"Medium",n6:"Demi-bold",n7:"Bold",n8:"Heavy",n9:"Black",n10:"Extra Black",i1:"Thin Italic",i2:"Extra Light Italic",i3:"Light Italic",i4:"Regular Italic",i5:"Medium Italic",i6:"Demi-bold Italic",i7:"Bold Italic",i8:"Heavy Italic",i9:"Black Italic",i10:"Extra Black Italic",100:"Thin",200:"Extra Light",300:"Light",400:"Regular",500:"Medium",600:"Demi-bold",700:"Bold",800:"Heavy",900:"Black",1000:"Extra Black","100italic":"Thin Italic","200italic":"Extra Light Italic","300italic":"Light Italic","400italic":"Regular Italic","500italic":"Medium Italic","600italic":"Demi-bold Italic","700italic":"Bold Italic","800italic":"Heavy Italic","900italic":"Black Italic","1000italic":"Extra Black Italic"};$(".uf-group-key").click(function(){var t=this.id,e=t+"-fonts";return $(this).hasClass("uf-group-key-gf")&&$(".uf-group-key-for-gf").removeClass("shown").addClass("hidden"),$(this).hasClass("uf-group-key-tk")&&$(".uf-group-key-for-tk").removeClass("shown").addClass("hidden"),$(this).hasClass("uf-group-key-fs")&&$(".uf-group-key-for-fs").removeClass("shown").addClass("hidden"),$("#"+e).removeClass("hidden").addClass("shown"),!1}),$("#uf-font-stack li").live("click",function(){$(this).addClass("selected").siblings().removeClass("selected");for(var s=$(this).find(".uf-font-family").text(),a=t.length,n=0;a>n;n++){var i=t[n];if(s==i.family){var l="<h2>"+i.family+"</h2>";""!=i.generic&&(l+="<strong>Generic</strong>: <em>"+i.generic+"</em><br/>"),""!=i.source&&(l+="<strong>From</strong>: <em>"+i.source+"</em>");var f,o,r,u,c,d;if(c="",d="","undefined"!=typeof i.variants){var h,p;i.variants.indexOf(",")<0?(h=new Array,h[0]=i.variants):h=i.variants.split(","),p=i.selvariants;var v,b=h.length,m,y;if(b>0){if(c+="<div class='uf-all-variants'>",c+="<h3>",c+="Variants","Font Squirrel"==i.source&&(c+='<span class="selectors">Selectors</span>'),c+="</h3>",c+="<ul class='uf-variant-list'>",1==b)c+="<li>","undefined"!=typeof e[h[0]]?(m=e[h[0]],c+=m+" ("+h[0]+")"):c+=h[0].substr(0,1).toUpperCase()+h[0].substr(1),"Font Squirrel"==i.source&&(v=i.variantselectors,c+='<input type="text" class="uf-variant-font-selector uf-variant-font-selector-'+h[0]+" uf-variant-font-selector-base-"+i.stub+'" value="'+v+'"/>'),c+="</li>";else for("Font Squirrel"==i.source&&(v=i.variantselectors,v=v.split("|")),f=0;b>f;f++)c+="<li>",c+="<label>",r=new RegExp("\\b"+h[f]+"\\b"),u=r.exec(p),o=null!=u?" checked='checked' ":"",c+="<input type='checkbox' "+o+" class='uf-variant-list-cb' id='uf-variant-"+h[f]+"'/>","undefined"!=typeof e[h[f]]?(m=e[h[f]],c+=m+" ("+h[f]+")"):c+=h[f].substr(0,1).toUpperCase()+h[f].substr(1),c+="</label>","Font Squirrel"==i.source&&(c+='<input type="text" class="uf-variant-font-selector uf-variant-font-selector-'+h[f]+" uf-variant-font-selector-base-"+i.stub+'" value="'+v[f]+'" />'),c+="</li>";c+="</ul>",c+="</div>"}}if("undefined"!=typeof i.subsets&&""!=i.subsets){var g,k;k=i.selsubsets,i.subsets.indexOf(",")<0?(g=new Array,g[0]=i.subsets):g=i.subsets.split(",");var x=g.length;if(x>0){if(d+="<div class='uf-all-subsets'>",d+="<h3>Subsets</h3>",d+="<ul class='uf-subset-list'>",1==x)d+="<li>"+g[0].substr(0,1).toUpperCase()+g[0].substr(1)+"</li>";else for(f=0;x>f;f++)d+="<li>",d+="<label>",r=new RegExp("\\b"+g[f]+"\\b"),u=r.exec(k),o=null!=u?" checked='checked' ":"",d+="<input type='checkbox' "+o+" class='uf-subset-list-cb' id='uf-subset-"+g[f]+"'/>",d+=g[f].substr(0,1).toUpperCase()+g[f].substr(1),d+="</label>",d+="</li>";d+="</ul>",d+="</div>"}}if(l+=""==d||""==c?c+d:'<div class="uf-variant-subset">'+c+d+"</div>","Font Squirrel"!=i.source){var w="";"undefined"!=typeof i.selectors&&""!=i.selectors&&(w=i.selectors),l+="<div class='uf-selector'><h3>Selectors</h3><label>CSS Selectors (Enter a comma-separated list. E.g. h1,h2,.pagetitle,#post-id):<input type='text' id='uf-font-selectors' value='"+w+"'/></label></div>"}$("#uf-font-details").hide().html(l).fadeIn();break}}}),$(".uf-variant-list-cb,.uf-subset-list-cb,#uf-font-selectors").live("change",function(){var e=$(this).parents("#uf-font-details").find("h2").text(),s;$(this).hasClass("uf-variant-list-cb")?s=this.id.substr(11):$(this).hasClass("uf-subset-list-cb")&&(s=this.id.substr(10));for(var a=t.length,n,i=0;a>i;i++)if(t[i].family==e){n=t[i];var l;$(this).hasClass("uf-variant-list-cb")?l=n.selvariants:$(this).hasClass("uf-subset-list-cb")&&(l=n.selsubsets),$(this).hasClass("uf-variant-list-cb")||$(this).hasClass("uf-subset-list-cb")?(l=l.indexOf(",")>-1?l.split(","):new Array(l),l=$.map(l,function(t){return s==t?null:t}),l=l.join(",")):l=$(this).val(),$(this).hasClass("uf-variant-list-cb")?t[i].selvariants=l:$(this).hasClass("uf-subset-list-cb")?t[i].selsubsets=l:t[i].selectors=l;break}$("#font_stack").val(JSON.stringify(t))}),$(".uf-variant-font-selector").live("change",function(){for(var e=$(this).attr("class").split(/\s+/),s=e.length,a=0;s>a;a++)if("uf-variant-font-selector-base-"==e[a].substr(0,30)){for(var n=e[a].substr(30),i=t.length,l=0;i>l;l++)if("undefined"!=typeof t[l].stub&&t[l].stub==n){var f=new Array,o=$(".uf-variant-font-selector");$.each(o,function(t){f[t]=$(this).val()}),f=f.join("|"),t[l].variantselectors=f}break}$("#font_stack").val(JSON.stringify(t))}),$(".uf-add-font").live("click",function(){for(var e=$(this).parents(".uf-fonts-for li").children(".uf-list-family").text(),s=t.length,a=0;s>a;a++)if(e==t[a].family)return!1;var n=$(this).parents(".uf-fonts-for li"),i,l,f,o,r,u,c,d,h,p;if(u="",d="",h="",p="",$(this).hasClass("uf-add-font-gf"))c=$("<link>"),c.attr({type:"text/css",rel:"stylesheet",href:"//fonts.googleapis.com/css?family="+encodeURIComponent(e)}),$("head").append(c),i="Google Web Fonts",o="",r="",l=$(n).children(".uf-font-variants").text(),f=$(n).children(".uf-font-subsets").text();else if($(this).hasClass("uf-add-font-tk"))i="Typekit",o="",r=$(n).children(".uf-font-stub").text(),l=$(n).children(".uf-font-variants").text(),f=$(n).children(".uf-font-subsets").text();else if($(this).hasClass("uf-add-font-fd"))i="Fontdeck",o="",r="",l=$(n).children(".uf-font-variants").text(),f=$(n).children(".uf-font-subsets").text();else if($(this).hasClass("uf-add-font-fs")){i="Font Squirrel",o="",r=$(n).children(".uf-font-stub").text(),c=$("<link>"),c.attr({type:"text/css",rel:"stylesheet",href:UncodeFontJS.font_dir_url+r+"/stylesheet.css"}),$("head").append(c),l=$(n).children(".uf-font-variants").text();for(var v=l.split(","),b=new Array,m=0;m<v.length;m++)b[m]="";p=b.join("|"),h=l.indexOf(",")>0?l.substr(0,l.indexOf(",")):l,u=$(n).children(".uf-font-variants-files").text(),f=$(n).children(".uf-font-subsets").text(),d=$(n).children(".uf-font-family-id").text()}return""==h&&(h=""==r?'"'+e+'"':r),$("#uf-font-stack").append($("<li><span class='sample' style='font-family: "+h+";'>Mr. Jock, TV quiz Ph.D., bags few lynx.</span><span class='uf-stack-meta'><span class='uf-font-family'>"+e+"</span> <i class='fa fa-cross uf-remove-font'></i></span></span></li>").hide().fadeIn()),t[t.length]={family:e,familyID:d,source:i,stub:r,generic:o,variants:l,selvariants:l,variantselectors:p,files:u,subsets:f,selsubsets:f},$("#font_stack").val(JSON.stringify(t)),$("html, body").animate({scrollTop:0},"slow"),!1}),$(".uf-download-font").live("click",function(t){var e=$(this),s=$(this).parents(".uf-fonts-for li"),a="<a href='#' class='uf-add-font uf-add-font-fs' title='Add'><i class='fa fa-plus2'></i></a>",n="<a href='#' class='uf-delete-download uf-delete-download-fs' title='Delete Download'><i class='fa fa-cross'></i></a>",i=$(s).children(".uf-font-stub").text(),l=$(s).children(".uf-font-variants"),f=$(s).children(".uf-font-variants-files");if(0==l.length&&(l=$("<span class='uf-font-variants'></span>").appendTo(s)),0==f.length&&(f=$("<span class='uf-font-variants-files'></span>").appendTo(s)),$(this).hasClass("uf-download-font-fs")){var o="http://www.fontsquirrel.com/fontfacekit/"+encodeURIComponent(i);$('<div class="uf-font-wip">&nbsp;</div>').prependTo($(this).parents("li")),$.post(UncodeFontJS.ajaxurl,"action=uncodefont_download_font&font_url="+o+"&nonce="+UncodeFontJS.nonce,function(t){if(t.indexOf("<form")>-1)return $(".uf-font-wip").after($(t)),$(".uf-font-wip").remove(),$("#uf-fs-Blackletter-fonts form").on("submit",function(t){return t.preventDefault(),$.post(this.getAttribute("action")+"&fileaccess=other","action=uncodefont_download_font&font_url="+o+"&"+$(this).serialize(),function(t){var i=$.parseJSON(t);"undefined"==typeof i.success?alert("Font download failed!"):("undefined"!=typeof i.variants&&$(l).text(i.variants),"undefined"!=typeof i.files&&$(f).text(i.files),$(e).fadeOut(500,function(t){var e=$(s).children(".uf-prev-add");$(this).remove(),$(e).append(a).fadeIn(),$(e).append(n).fadeIn()})),$(".uf-font-wip").remove(),$("#uf-fs-Blackletter-fonts form").remove()}),!1}),!1;var i=$.parseJSON(t);"undefined"==typeof i.success?alert("Font download failed!"):("undefined"!=typeof i.variants&&$(l).text(i.variants),"undefined"!=typeof i.files&&$(f).text(i.files),$(e).fadeOut(500,function(t){var e=$(s).children(".uf-prev-add");$(this).remove(),$(e).append(a).fadeIn(),$(e).append(n).fadeIn()})),$(".uf-font-wip").remove()})}return!1}),$(".uf-delete-download").live("click",function(t){var e=$(this),s="<a href='#' class='uf-download-font uf-download-font-fs' title='Download'><i class='fa fa-arrow-down2'></i></a>",a=$(this).parents(".uf-fonts-for li").children(".uf-font-stub").text();return $(this).hasClass("uf-delete-download-fs")&&($('<div class="uf-font-wip">&nbsp;</div>').prependTo($(this).parents("li")),$.post(UncodeFontJS.ajaxurl,"action=uncodefont_delete_download&font_family="+a,function(t){var a=$.parseJSON(t);"undefined"==typeof a.success?alert("Font deletion failed!"):$(e).fadeOut(500,function(t){var e=$(this).parents(".uf-fonts-for li").children(".uf-prev-add"),a=$(e).children(".uf-add-font");$(a).fadeOut().remove(),$(this).remove(),$(e).append(s).fadeIn()}),$(".uf-font-wip").remove()})),!1}),$(".uf-remove-font").live("click",function(){var e=$(this).siblings(".uf-font-family").text();return t=$.map(t,function(t){return e==t.family?null:t}),$(this).parents("#uf-font-stack li").fadeOut(500,function(){$(this).remove(),0==$("#uf-font-stack").children().length?$(".uf-font-details").html("<h2>Add Fonts</h2>You have no fonts in your stack. Please add a font first from the sources below. If you don't see any fonts below, make sure you have set up the <a href='admin.php?page=uncodefont-settings'>Font Sources</a> correctly."):$(".uf-font-details h2").text()==e&&$(".uf-font-details").html("<h2>Preview</h2>Select a font from the left to see its details.")}),$("#font_stack").val(JSON.stringify(t)),!1})});