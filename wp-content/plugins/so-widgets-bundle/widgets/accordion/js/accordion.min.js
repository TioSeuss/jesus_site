var sowb=window.sowb||{};jQuery(function(h){sowb.setupAccordion=function(){h(".sow-accordion").each(function(o,n){var e=h(this).closest(".so-widget-sow-accordion");if(e.data("initialized"))return h(this);var t=h(n).find("> .sow-accordion-panel");t.not(".sow-accordion-panel-open").find(".sow-accordion-panel-content").hide();var s=t.filter(".sow-accordion-panel-open").toArray(),c=function(){},r=function(o,n){var a=o.offset().top-90;n?h("body,html").animate({scrollTop:a},200):window.scrollTo(0,a)},d=function(o,n,a){var i=h(o);if(!i.is(".sow-accordion-panel-open")){i.find("> .sow-accordion-panel-content").slideDown(function(){a&&i.offset().top<window.scrollY&&r(i,!0),h(this).trigger("show"),h(sowb).trigger("setup_widgets")}),i.addClass("sow-accordion-panel-open"),s.push(o);var e=h(o).parents(".sow-accordion-panel");e.length&&!e.hasClass("sow-accordion-panel-open")&&d(e.get(0),!0),n||c()}},l=function(o,n){var a=h(o);a.is(".sow-accordion-panel-open")&&(a.find("> .sow-accordion-panel-content").slideUp(function(){h(this).trigger("hide")}),a.removeClass("sow-accordion-panel-open"),s.splice(s.indexOf(o),1),n||c())};if(t.find("> .sow-accordion-panel-header").click(function(){var o=h(this),a=e.data("maxOpenPanels"),n=o.closest(".sow-accordion-panel");if(n.is(".sow-accordion-panel-open")?l(n.get(0)):d(n.get(0),!1,!0),!isNaN(a)&&0<a&&s.length>a){var i=0;h.each(s.reverse(),function(o,n){i!==a?i++:l(s[o])})}}),e.data("useAnchorTags")){var a;c=function(){a&&clearTimeout(a),a=setTimeout(function(){for(var o=[],n=h(".sow-accordion-panel-open").toArray(),a=0;a<n.length;a++){var i=h(n[a]).data("anchor");if(i){var e=h(n[a]).parents(".sow-accordion-panel");(!e.length||e.length&&e.hasClass("sow-accordion-panel-open"))&&(o[a]=i)}}o&&o.length?window.location.hash=o.join(","):window.location.hash&&window.history.pushState("",document.title,window.location.pathname+window.location.search)},100)};var i=function(){for(var o=t.toArray(),n=0;n<o.length;n++){var a=o[n],i=h(a).data("anchor"),e=window.location.hash.substring(1).split(",");i&&-1<h.inArray(i,e)?d(a,!0):l(a,!0)}};h(window).on("hashchange",i),window.location.hash?i():c();var w=e.data("initialScrollPanel");if(0<w){var p=w>t.length?t.last():t.eq(w-1);setTimeout(function(){r(p)},500)}}e.data("initialized",!0)})},sowb.setupAccordion(),h(sowb).on("setup_widgets",sowb.setupAccordion)}),window.sowb=sowb;