!function(l){OT_UI.uncode_init=function(){OT_UI.adaptive()},OT_UI.adaptive=function(){l(document).on("ready",function(){0<l("#option-tree-settings-api").length&&l.ajax({url:option_tree.ajax,type:"post",dataType:"json",data:{action:"list_images"},complete:function(e){l("#setting__uncode_adaptive").append('<div id="ai-space-wrap" />'),l("#ai-space-wrap").append('<div class="ai-space">'+e.responseJSON.data.message+"</div>");var t=l('<button class="option-tree-ui-button button">Delete all AI images</button>');t.on("click",function(e){e.preventDefault();var t=l(this);return t.addClass("disabled"),t.html("Deletingâ€¦"),l.ajax({url:option_tree.ajax,type:"post",dataType:"json",data:{action:"list_images",erase:!0},complete:function(e){t.removeClass("disabled"),t.html("Delete all AI images"),l("#ai-space-wrap .ai-space").html(e.responseJSON.data.message)}}),!1}),l("#ai-space-wrap").append(t)}})})},OT_UI.fix_upload_parent=function(){},OT_UI.init_select_wrapper=function(){l(".option-tree-ui-select").each(function(){l(this).parent().hasClass("select-wrapper")||l(this).wrap('<div class="select-wrapper" />'),l(this).hasClass("uncode-color-select")&&(l(this).closest(".select-wrapper").addClass("select-uncode-colors"),-1==window.navigator.userAgent.indexOf("Windows NT 10.0")&&l(this).easyDropDown({cutOff:10}))}),l(document).on({mouseenter:function(){l(this).closest(".select-wrapper.hide-arrow").addClass("hover")},mouseleave:function(){l(this).closest(".select-wrapper.hide-arrow").removeClass("hover")}},".select-input-mixed"),l(document).on("click",".select-input-wrapper span",function(){l(this).prev("input").val("")}),l(document).on("focus",".select-input-mixed-field",function(){l(this).val("")}),l(document).on("change","input.select-input-mixed-field-text",function(){l(this).closest(".select-wrapper").find("input.select-input-mixed-field-value").val(l(this).val())}),l(document).on(l.browser.msie?"click":"change",".option-tree-ui-select",function(e){l(this).hasClass("select-input-mixed")&&(l(this).closest(".select-wrapper").find("input.select-input-mixed-field-text ").val(l(this).find("option:selected").text()),l(this).closest(".select-wrapper").find("input.select-input-mixed-field-value").val(l(this).find("option:selected").val()))})},OT_UI.init_upload=function(){l(document).on("click",".ot_upload_media",function(e){e.preventDefault();var n={},o="uncode-editor",t=wp.media.view.AttachmentsBrowser,i=wp.media,s=l(this).parent(".option-tree-ui-upload-parent").find("input").attr("id"),a=(l(this).attr("rel"),l("#"+s).val()),d="";n[o]||(i.view.uploadMediaView=i.View.extend({tagName:"div",className:"uploader-uncode-media",template:i.template("uploader-uncode-media"),events:{"click .close":"hide","paste #mle-code":"entercode","input #mle-code":"entercode"},oembed_callback:function(e,t,i){var a=(null!=window.workflow?workflow:wp.media.frame).$el;$button=a.find(".media-button"),$spinner=a.find(".spinner"),""!=e&&(a.find("#mle-mime").val(e),a.find("#mle-width").val(t),a.find("#mle-height").val(i),$button.removeAttr("disabled"),$spinner.removeClass("visible"))},entercode:function(e){var t,i=this,a=l(this.$el),n=a.find("#mle-code"),o=a.find(".oembed_code"),s=a.find(".oembed"),d=a.find(".spinner");setTimeout(function(){t=n.val(),0==o.length?s.after('<div class="oembed_code">'+t+"</div>"):o.html(t),s.get_oembed(i.oembed_callback,!0),d.addClass("visible")},100)},recordmedia:function(){var e=l(this.$el),t=n[o].$el.find(".media-button-select");"uploader-uncode-media"==n[o].content.get().el.className?(t.attr("disabled","disabled"),l.ajax({type:"POST",dataType:"json",url:ajaxurl+"?action=recordMedia",data:e.find("input[name],select[name],textarea[name]").serialize(),success:function(e){isNaN(e.id)||null==e||(d+='<div class="option-tree-ui-image-wrap"><div class="oembed"><span class="spinner" style="display: block; float: left;"></span></div><div class="oembed_code" style="display: none;">'+e.url+"</div></div>",l("#"+s).val(e.id),l("#"+s+"_media").remove(),l("#"+s).parent().parent("div").append('<div class="option-tree-ui-media-wrap" id="'+s+'_media" />'),l("#"+s+"_media").append(d).slideDown(),l("#"+s+"_media .oembed").get_oembed(null,!0),l("#"+s+"_media .spinner").removeClass("visible"),t.removeAttr("disabled"),n[o].off("select"),n[o].close())}})):this.select()},ready:function(){var e=this;n[o].$el.find(".media-button-select").off("click").on("click",function(){e.recordmedia()})},select:function(){i.frame.toolbar.get("selection").selection.single();i.frame.close()}}),n[o]=i({title:l(this).attr("title"),button:{text:option_tree.upload_text},multiple:!1}),n[o].on("router:render:browse",function(e){e.set({upload:{text:"Upload Files",priority:20},browse:{text:"Media Library",priority:40},uncode:{text:"Upload oEmbed",priority:30}})}),n[o].on("content:render:uncode",function(){n[o].content.set(new i.view.uploadMediaView({controller:this}))}),n[o].on("close",function(){wp.media.view.AttachmentsBrowser=t}),n[o].on("select",function(){var e=n[o].state().get("selection").first(),t=e.attributes.url,i=e.attributes.id,a=e.attributes.mime;"oembed/svg"==a?d+='<div class="option-tree-ui-image-wrap">'+e.attributes.description+"</div>":a.match(/^image\/(?:jpe?g|png|url|gif|x-icon)$/i)?d+='<div class="option-tree-ui-image-wrap"><img src="'+t+'" alt="" /></div>':d+='<div class="option-tree-ui-image-wrap"><div class="oembed"><span class="spinner" style="display: block; float: left;"></span></div><div class="oembed_code" style="display: none;">'+t+"</div></div>",d+='<a href="javascript:(void);" class="option-tree-ui-remove-media option-tree-ui-button button button-secondary light" title="'+option_tree.remove_media_text+'"><span class="icon fa fa-minus2"></span>'+option_tree.remove_media_text+"</a>",l("#"+s).val(i),l("#"+s+"_media").remove(),l("#"+s).parent().parent("div").append('<div class="option-tree-ui-media-wrap" id="'+s+'_media" />'),l("#"+s+"_media").append(d).slideDown(),l("#"+s+"_media .oembed").get_oembed(),n[o].off("select"),n[o].close()}),n[o].on("open",function(){var e=n[o].state().get("selection"),t=i.attachment(a);t.fetch(),e.set(t)})),n[o].open()})},l(document).ready(function(){OT_UI.uncode_init()})}(jQuery),function(o){o(document).on("ready",function(){o.fn.loadIcons=function(){var t=o(this).fontIconPicker({theme:"fip-bootstrap"});o.ajax({url:SiteParameters.ICONS_PATH,type:"GET",dataType:"json"}).done(function(e){var i="fa "+e.preferences.fontPref.prefix,a=[],n=[];o.each(e.icons,function(e,t){a.push(i+t.properties.name.split(",")[0]),t.icon&&t.icon.tags&&t.icon.tags.length?n.push(t.properties.name+" "+t.icon.tags.join(" ")):n.push(t.properties.name)}),t.setIcons(a,n)})},o(".button_icon_container").each(function(){o(this).loadIcons()}),o(".hndle").on("mousedown",function(){var t=o(this).closest("div").attr("id");o(".wrap").on("mouseup",function(){var e={};o("#"+t+' input[type="radio"]').each(function(){o(this).is(":checked")&&(e[o(this).attr("name")]=o(this).val()),o(document).data("ot_checked_radios",e)}),setTimeout(function(){var e=o(document).data("ot_checked_radios");for(key in e)o('input[name="'+key+'"]').filter('[value="'+e[key]+'"]').trigger("click");o(".wrap").unbind("mouseup")},50)})}),o.each(o(".section-title-wrap"),function(){o(this).addClass("closed");var e=o(this).nextUntil(".section-title-wrap").wrapAll('<div class="hidden" />'),i=new Array;o.each(e,function(e,t){o(t).hasClass("break-master-wrap")&&i.push(t)}),o(i).wrapAll('<div class="overridable-wrap"><div class="overridable-inner"></div></div>'),o(this).on("click",function(){o(this).toggleClass("closed"),o(this).next().slideToggle()})})})}(window.jQuery);
