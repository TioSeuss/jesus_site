$=jQuery.noConflict(),jQuery(document).ready(function(m){m(".if-js-closed").removeClass("if-js-closed").addClass("closed"),postboxes.add_postbox_toggles("uncodefont");var g=UncodeFontJS.font_stack;g=m.parseJSON(g);var b={n1:"Thin",n2:"Extra Light",n3:"Light",n4:"Regular",n5:"Medium",n6:"Demi-bold",n7:"Bold",n8:"Heavy",n9:"Black",n10:"Extra Black",i1:"Thin Italic",i2:"Extra Light Italic",i3:"Light Italic",i4:"Regular Italic",i5:"Medium Italic",i6:"Demi-bold Italic",i7:"Bold Italic",i8:"Heavy Italic",i9:"Black Italic",i10:"Extra Black Italic",100:"Thin",200:"Extra Light",300:"Light",400:"Regular",500:"Medium",600:"Demi-bold",700:"Bold",800:"Heavy",900:"Black",1e3:"Extra Black","100italic":"Thin Italic","200italic":"Extra Light Italic","300italic":"Light Italic","400italic":"Regular Italic","500italic":"Medium Italic","600italic":"Demi-bold Italic","700italic":"Bold Italic","800italic":"Heavy Italic","900italic":"Black Italic","1000italic":"Extra Black Italic"};m(".uf-group-key").click(function(){var t=this.id+"-fonts";return m(this).hasClass("uf-group-key-gf")&&m(".uf-group-key-for-gf").removeClass("shown").addClass("hidden"),m(this).hasClass("uf-group-key-tk")&&m(".uf-group-key-for-tk").removeClass("shown").addClass("hidden"),m(this).hasClass("uf-group-key-fs")&&m(".uf-group-key-for-fs").removeClass("shown").addClass("hidden"),m("#"+t).removeClass("hidden").addClass("shown"),!1}),m("#uf-font-stack li").live("click",function(){m(this).addClass("selected").siblings().removeClass("selected");for(var t=m(this).find(".uf-font-family").text(),s=g.length,e=0;e<s;e++){var a=g[e];if(t==a.family){var i,n,l,o="<h2>"+a.family+"</h2>";if(""!=a.generic&&(o+="<strong>Generic</strong>: <em>"+a.generic+"</em><br/>"),""!=a.source&&(o+="<strong>From</strong>: <em>"+a.source+"</em>"),l=n="",void 0!==a.variants){var f,r,u;a.variants.indexOf(",")<0?(f=new Array)[0]=a.variants:f=a.variants.split(","),r=a.selvariants;var c=f.length;if(0<c){if(n+="<div class='uf-all-variants'>",n+="<h3>",n+="Variants","Font Squirrel"==a.source&&(n+='<span class="selectors">Selectors</span>'),n+="</h3>",n+="<ul class='uf-variant-list'>",1==c)n+="<li>",void 0!==b[f[0]]?n+=b[f[0]]+" ("+f[0]+")":n+=f[0].substr(0,1).toUpperCase()+f[0].substr(1),"Font Squirrel"==a.source&&(u=a.variantselectors,n+='<input type="text" class="uf-variant-font-selector uf-variant-font-selector-'+f[0]+" uf-variant-font-selector-base-"+a.stub+'" value="'+u+'"/>'),n+="</li>";else for("Font Squirrel"==a.source&&(u=(u=a.variantselectors).split("|")),i=0;i<c;i++)n+="<li>",n+="<label>",n+="<input type='checkbox' "+(null!=new RegExp("\\b"+f[i]+"\\b").exec(r)?" checked='checked' ":"")+" class='uf-variant-list-cb' id='uf-variant-"+f[i]+"'/>",void 0!==b[f[i]]?n+=b[f[i]]+" ("+f[i]+")":n+=f[i].substr(0,1).toUpperCase()+f[i].substr(1),n+="</label>","Font Squirrel"==a.source&&(n+='<input type="text" class="uf-variant-font-selector uf-variant-font-selector-'+f[i]+" uf-variant-font-selector-base-"+a.stub+'" value="'+u[i]+'" />'),n+="</li>";n+="</ul>",n+="</div>"}}if(void 0!==a.subsets&&""!=a.subsets){var d,h;h=a.selsubsets,a.subsets.indexOf(",")<0?(d=new Array)[0]=a.subsets:d=a.subsets.split(",");var v=d.length;if(0<v){if(l+="<div class='uf-all-subsets'>",l+="<h3>Subsets</h3>",l+="<ul class='uf-subset-list'>",1==v)l+="<li>"+d[0].substr(0,1).toUpperCase()+d[0].substr(1)+"</li>";else for(i=0;i<v;i++)l+="<li>",l+="<label>",l+="<input type='checkbox' "+(null!=new RegExp("\\b"+d[i]+"\\b").exec(h)?" checked='checked' ":"")+" class='uf-subset-list-cb' id='uf-subset-"+d[i]+"'/>",l+=d[i].substr(0,1).toUpperCase()+d[i].substr(1),l+="</label>",l+="</li>";l+="</ul>",l+="</div>"}}if(o+=""==l||""==n?n+l:'<div class="uf-variant-subset">'+n+l+"</div>","Font Squirrel"!=a.source){var p="";void 0!==a.selectors&&""!=a.selectors&&(p=a.selectors),o+="<div class='uf-selector'><h3>Selectors</h3><label>CSS Selectors (Enter a comma-separated list. E.g. h1,h2,.pagetitle,#post-id):<input type='text' id='uf-font-selectors' value='"+p+"'/></label></div>"}m("#uf-font-details").hide().html(o).fadeIn();break}}}),m(".uf-variant-list-cb,.uf-subset-list-cb,#uf-font-selectors").live("change",function(){var s,t=m(this).parents("#uf-font-details").find("h2").text();m(this).hasClass("uf-variant-list-cb")?s=this.id.substr(11):m(this).hasClass("uf-subset-list-cb")&&(s=this.id.substr(10));for(var e,a=g.length,i=0;i<a;i++)if(g[i].family==t){var n;e=g[i],m(this).hasClass("uf-variant-list-cb")?n=e.selvariants:m(this).hasClass("uf-subset-list-cb")&&(n=e.selsubsets),m(this).hasClass("uf-variant-list-cb")||m(this).hasClass("uf-subset-list-cb")?(n=-1<n.indexOf(",")?n.split(","):new Array(n),n=(n=m.map(n,function(t){return s==t?null:t})).join(",")):n=m(this).val(),m(this).hasClass("uf-variant-list-cb")?g[i].selvariants=n:m(this).hasClass("uf-subset-list-cb")?g[i].selsubsets=n:g[i].selectors=n;break}m("#font_stack").val(JSON.stringify(g))}),m(".uf-variant-font-selector").live("change",function(){for(var t=m(this).attr("class").split(/\s+/),s=t.length,e=0;e<s;e++)if("uf-variant-font-selector-base-"==t[e].substr(0,30)){for(var a=t[e].substr(30),i=g.length,n=0;n<i;n++)if(void 0!==g[n].stub&&g[n].stub==a){var l=new Array,o=m(".uf-variant-font-selector");m.each(o,function(t){l[t]=m(this).val()}),l=l.join("|"),g[n].variantselectors=l}break}m("#font_stack").val(JSON.stringify(g))}),m(".uf-add-font").live("click",function(){for(var t=m(this).parents(".uf-fonts-for li").children(".uf-list-family").text(),s=g.length,e=0;e<s;e++)if(t==g[e].family)return!1;var a,i,n,l,o,f,r,u,c,d,h=m(this).parents(".uf-fonts-for li");if(d=c=u=f="",m(this).hasClass("uf-add-font-gf"))(r=m("<link>")).attr({type:"text/css",rel:"stylesheet",href:"//fonts.googleapis.com/css?family="+encodeURIComponent(t)}),m("head").append(r),a="Google Web Fonts",o=l="",i=m(h).children(".uf-font-variants").text(),n=m(h).children(".uf-font-subsets").text();else if(m(this).hasClass("uf-add-font-tk"))a="Adobe Fonts",l="",o=m(h).children(".uf-font-stub").text(),i=m(h).children(".uf-font-variants").text(),n=m(h).children(".uf-font-subsets").text();else if(m(this).hasClass("uf-add-font-fd"))a="Fontdeck",o=l="",i=m(h).children(".uf-font-variants").text(),n=m(h).children(".uf-font-subsets").text();else if(m(this).hasClass("uf-add-font-fs")){a="Font Squirrel",l="",o=m(h).children(".uf-font-stub").text(),(r=m("<link>")).attr({type:"text/css",rel:"stylesheet",href:UncodeFontJS.font_dir_url+o+"/stylesheet.css"}),m("head").append(r);for(var v=(i=m(h).children(".uf-font-variants").text()).split(","),p=new Array,b=0;b<v.length;b++)p[b]="";d=p.join("|"),c=0<i.indexOf(",")?i.substr(0,i.indexOf(",")):i,f=m(h).children(".uf-font-variants-files").text(),n=m(h).children(".uf-font-subsets").text(),u=m(h).children(".uf-font-family-id").text()}return""==c&&(c=""==o?'"'+t+'"':o),m("#uf-font-stack").append(m("<li><span class='sample' style='font-family: "+c+";'>Mr. Jock, TV quiz Ph.D., bags few lynx.</span><span class='uf-stack-meta'><span class='uf-font-family'>"+t+"</span> <i class='fa fa-cross uf-remove-font'></i></span></span></li>").hide().fadeIn()),g[g.length]={family:t,familyID:u,source:a,stub:o,generic:l,variants:i,selvariants:i,variantselectors:d,files:f,subsets:n,selsubsets:n},m("#font_stack").val(JSON.stringify(g)),m("html, body").animate({scrollTop:0},"slow"),!1}),m(".uf-download-font").live("click",function(t){var e=m(this),a=m(this).parents(".uf-fonts-for li"),i="<a href='#' class='uf-add-font uf-add-font-fs' title='Add'><i class='fa fa-plus2'></i></a>",n="<a href='#' class='uf-delete-download uf-delete-download-fs' title='Delete Download'><i class='fa fa-cross'></i></a>",s=m(a).children(".uf-font-stub").text(),l=m(a).children(".uf-font-variants"),o=m(a).children(".uf-font-variants-files");if(0==l.length&&(l=m("<span class='uf-font-variants'></span>").appendTo(a)),0==o.length&&(o=m("<span class='uf-font-variants-files'></span>").appendTo(a)),m(this).hasClass("uf-download-font-fs")){var f="http://www.fontsquirrel.com/fontfacekit/"+encodeURIComponent(s);m('<div class="uf-font-wip">&nbsp;</div>').prependTo(m(this).parents("li")),m.post(UncodeFontJS.ajaxurl,"action=uncodefont_download_font&font_url="+f+"&nonce="+UncodeFontJS.nonce,function(t){if(-1<t.indexOf("<form"))return m(".uf-font-wip").after(m(t)),m(".uf-font-wip").remove(),m("#uf-fs-Blackletter-fonts form").on("submit",function(t){return t.preventDefault(),m.post(this.getAttribute("action")+"&fileaccess=other","action=uncodefont_download_font&font_url="+f+"&"+m(this).serialize(),function(t){var s=m.parseJSON(t);void 0===s.success?alert("Font download failed!"):(void 0!==s.variants&&m(l).text(s.variants),void 0!==s.files&&m(o).text(s.files),m(e).fadeOut(500,function(t){var s=m(a).children(".uf-prev-add");m(this).remove(),m(s).append(i).fadeIn(),m(s).append(n).fadeIn()})),m(".uf-font-wip").remove(),m("#uf-fs-Blackletter-fonts form").remove()}),!1}),!1;var s=m.parseJSON(t);void 0===s.success?alert("Font download failed!"):(void 0!==s.variants&&m(l).text(s.variants),void 0!==s.files&&m(o).text(s.files),m(e).fadeOut(500,function(t){var s=m(a).children(".uf-prev-add");m(this).remove(),m(s).append(i).fadeIn(),m(s).append(n).fadeIn()})),m(".uf-font-wip").remove()})}return!1}),m(".uf-delete-download").live("click",function(t){var s=m(this),e=m(this).parents(".uf-fonts-for li").children(".uf-font-stub").text();return m(this).hasClass("uf-delete-download-fs")&&(m('<div class="uf-font-wip">&nbsp;</div>').prependTo(m(this).parents("li")),m.post(UncodeFontJS.ajaxurl,"action=uncodefont_delete_download&font_family="+e,function(t){void 0===m.parseJSON(t).success?alert("Font deletion failed!"):m(s).fadeOut(500,function(t){var s=m(this).parents(".uf-fonts-for li").children(".uf-prev-add"),e=m(s).children(".uf-add-font");m(e).fadeOut().remove(),m(this).remove(),m(s).append("<a href='#' class='uf-download-font uf-download-font-fs' title='Download'><i class='fa fa-arrow-down2'></i></a>").fadeIn()}),m(".uf-font-wip").remove()})),!1}),m(".uf-remove-font").live("click",function(){var s=m(this).siblings(".uf-font-family").text();return g=m.map(g,function(t){return s==t.family?null:t}),m(this).parents("#uf-font-stack li").fadeOut(500,function(){m(this).remove(),0==m("#uf-font-stack").children().length?m(".uf-font-details").html("<h2>Add Fonts</h2>You have no fonts in your stack. Please add a font first from the sources below. If you don't see any fonts below, make sure you have set up the <a href='admin.php?page=uncodefont-settings'>Font Sources</a> correctly."):m(".uf-font-details h2").text()==s&&m(".uf-font-details").html("<h2>Preview</h2>Select a font from the left to see its details.")}),m("#font_stack").val(JSON.stringify(g)),!1})});
